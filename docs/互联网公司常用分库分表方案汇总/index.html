<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-notes/wechat/互联网公司常用分库分表方案汇总">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">互联网公司常用分库分表方案汇总 | 彼岸_未来</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://science09.github.io/docs/互联网公司常用分库分表方案汇总"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="互联网公司常用分库分表方案汇总 | 彼岸_未来"><meta data-rh="true" name="description" content="一、数据库瓶颈"><meta data-rh="true" property="og:description" content="一、数据库瓶颈"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://science09.github.io/docs/互联网公司常用分库分表方案汇总"><link data-rh="true" rel="alternate" href="https://science09.github.io/docs/互联网公司常用分库分表方案汇总" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://science09.github.io/docs/互联网公司常用分库分表方案汇总" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="彼岸_未来 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="彼岸_未来 Atom Feed"><link rel="stylesheet" href="/assets/css/styles.e07c85a0.css">
<link rel="preload" href="/assets/js/runtime~main.b8772c3e.js" as="script">
<link rel="preload" href="/assets/js/main.6900f799.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a href="#" class="skipToContent_fXgn">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA" style="border-radius:70%"><img src="/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU" style="border-radius:70%"></div><b class="navbar__title text--truncate">彼岸_未来</b></a><a class="navbar__item navbar__link" href="/blog">个人笔记</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/notes-intro">技术文摘</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/science09" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/notes-intro">介绍</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/分布式唯一 ID 生成方案">公众号文章</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/分布式唯一 ID 生成方案">分布式唯一 ID 生成方案</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/how_dose_linux_filesystem_work">Linux文件系统是如何工作的？</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/mysql_MVCC_and_its_implementation_principle">深入理解 MySQL 的 MVCC 及实现原理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/从0.742秒到0.006秒，MySQL百万数据深分页优化实战">从0.742秒到0.006秒，MySQL百万数据深分页优化实战</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/30条永不过时的SQL优化技巧">30条永不过时的SQL优化技巧</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/21个MySQL表设计的经验准则">21个MySQL表设计的经验准则</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/MySQL的普通索引和唯一索引到底什么区别？">MySQL的普通索引和唯一索引到底什么区别？</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图文结合！Redis延迟队列golang高效实践">图文结合！Redis延迟队列golang高效实践</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/3种方式！Go Error处理最佳实践">3种方式！Go Error处理最佳实践</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/推荐系统 embedding 技术实践总结">推荐系统 embedding 技术实践总结</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Go几个黑魔法技巧汇总">Go几个黑魔法技巧汇总</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Redis详细介绍一篇就够">Redis详细介绍一篇就够</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/快速实现一个分布式定时器">快速实现一个分布式定时器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/如何做架构设计和评审">如何做架构设计和评审</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/面试官：为什么说mysql数据库单表最大两千万？">面试官：为什么说mysql数据库单表最大两千万？</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/【系统设计】S3 对象存储">【系统设计】S3 对象存储</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/B站在全链路压测上的实践">B站在全链路压测上的实践</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/小红书KV存储架构：万亿级数据与跨云多活不在话下">小红书KV存储架构：万亿级数据与跨云多活不在话下</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/网易严选商品中心DDD实践">网易严选商品中心DDD实践</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/社区点赞业务缓存设计优化探索 ｜ 得物技术">社区点赞业务缓存设计优化探索 ｜ 得物技术</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/缓存高频面试题：缓存穿透？缓存击穿？缓存雪崩？">缓存高频面试题：缓存穿透？缓存击穿？缓存雪崩？</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/十几亿用户中心系统，ES+Redis+MySQL架构就轻松搞定！">十几亿用户中心系统，ES+Redis+MySQL架构就轻松搞定！</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/京东售后系统架构设计：专治多端并发、数据不一致的臭毛病">京东售后系统架构设计：专治多端并发、数据不一致的臭毛病</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2000万日订单背后，如何保障系统的高可用？">2000万日订单背后，如何保障系统的高可用？</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Docker 网络4种模式详解">Docker 网络4种模式详解</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/去哪儿网业务缓存体系的升级改造">去哪儿网业务缓存体系的升级改造</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/架构师技术路线图">架构师技术路线图</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/10年后，再审视Heroku发布的十二要素应用">10年后，再审视Heroku发布的十二要素应用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/互联网公司常用分库分表方案汇总">互联网公司常用分库分表方案汇总</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/docs/resources-webtool">资源</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/resources-webtool">工具网站列表</a></li></ul></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">公众号文章</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">互联网公司常用分库分表方案汇总</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>互联网公司常用分库分表方案汇总</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="一数据库瓶颈">一、数据库瓶颈<a class="hash-link" href="#一数据库瓶颈" title="标题的直接链接">​</a></h2><p>不管是IO瓶颈，还是CPU瓶颈，最终都会导致数据库的活跃连接数增加，进而逼近甚至达到数据库可承载活跃连接数的阈值。在业务Service来看就是，可用数据库连接少甚至无连接可用。接下来就可以想象了吧（并发量、吞吐量、崩溃）。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1io瓶颈">1、IO瓶颈<a class="hash-link" href="#1io瓶颈" title="标题的直接链接">​</a></h3><p>第一种：磁盘读IO瓶颈，热点数据太多，数据库缓存放不下，每次查询时会产生大量的IO，降低查询速度 -&gt; 分库和垂直分表。第二种：网络IO瓶颈，请求的数据太多，网络带宽不够 -&gt; 分库。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2cpu瓶颈">2、CPU瓶颈<a class="hash-link" href="#2cpu瓶颈" title="标题的直接链接">​</a></h3><p>第一种：SQL问题，如SQL中包含join，group by，order by，非索引字段条件查询等，增加CPU运算的操作 -&gt; SQL优化，建立合适的索引，在业务Service层进行业务计算。第二种：单表数据量太大，查询时扫描的行太多，SQL效率低，CPU率先出现瓶颈 -&gt; 水平分表。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="二分库分表"><strong>二、分库分表</strong><a class="hash-link" href="#二分库分表" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1水平分库">1、水平分库<a class="hash-link" href="#1水平分库" title="标题的直接链接">​</a></h3><p><img loading="lazy" alt="Untitled" src="/assets/images/e2dbc85c0b5f917b-03751c47d40d33921c000a16c7429b6c.png" width="692" height="280" class="img_ev3q"></p><p><strong>概念：</strong>以字段为依据，按照一定策略（hash、range等），将一个库中的数据拆分到多个库中。</p><p><strong>结果：</strong></p><ul><li><p>每个库的结构都一样；</p></li><li><p>每个库的数据都不一样，没有交集；</p></li><li><p>所有库的并集是全量数据；</p></li></ul><p><strong>场景：</strong>系统绝对并发量上来了，分表难以根本上解决问题，并且还没有明显的业务归属来垂直分库。<strong>分析：</strong>库多了，io和cpu的压力自然可以成倍缓解。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2水平分表">2、水平分表<a class="hash-link" href="#2水平分表" title="标题的直接链接">​</a></h3><p><img loading="lazy" alt="Untitled" src="data:image/png;base64,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" width="327" height="286" class="img_ev3q"></p><p><strong>概念：</strong>以字段为依据，按照一定策略（hash、range等），将一个表中的数据拆分到多个表中。</p><p><strong>结果：</strong></p><ul><li><p>每个表的结构都一样；</p></li><li><p>每个表的数据都不一样，没有交集；</p></li><li><p>所有表的并集是全量数据；</p></li></ul><p><strong>场景：</strong>系统绝对并发量并没有上来，只是单表的数据量太多，影响了SQL效率，加重了CPU负担，以至于成为瓶颈。</p><p><strong>分析：</strong>表的数据量少了，单次SQL执行效率高，自然减轻了CPU的负担。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3垂直分库">3、垂直分库<a class="hash-link" href="#3垂直分库" title="标题的直接链接">​</a></h3><p><img loading="lazy" alt="Untitled" src="/assets/images/b650bc1b59ef76ba-e36ba8517095432dfcc19eb81d3845fe.png" width="463" height="228" class="img_ev3q"></p><p><strong>概念：</strong>以表为依据，按照业务归属不同，将不同的表拆分到不同的库中。</p><p><strong>结果：</strong></p><ul><li><p>每个库的结构都不一样；</p></li><li><p>每个库的数据也不一样，没有交集；</p></li><li><p>所有库的并集是全量数据；</p></li></ul><p><strong>场景：</strong>系统绝对并发量上来了，并且可以抽象出单独的业务模块。<strong>分析：</strong>到这一步，基本上就可以服务化了。例如，随着业务的发展一些公用的配置表、字典表等越来越多，这时可以将这些表拆到单独的库中，甚至可以服务化。再有，随着业务的发展孵化出了一套业务模式，这时可以将相关的表拆到单独的库中，甚至可以服务化。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="4垂直分表">4、垂直分表<a class="hash-link" href="#4垂直分表" title="标题的直接链接">​</a></h3><p><img loading="lazy" alt="Untitled" src="/assets/images/3fe09ecc9cbcbc7d-5353da23c74e8646385dee8175733bce.png" width="556" height="206" class="img_ev3q"></p><p><strong>概念：</strong>以字段为依据，按照字段的活跃性，将表中字段拆到不同的表（主表和扩展表）中。</p><p><strong>结果：</strong></p><ul><li><p>每个表的结构都不一样；</p></li><li><p>每个表的数据也不一样，一般来说，每个表的字段至少有一列交集，一般是主键，用于关联数据；</p></li><li><p>所有表的并集是全量数据；</p></li></ul><p><strong>场景：</strong>系统绝对并发量并没有上来，表的记录并不多，但是字段多，并且热点数据和非热点数据在一起，单行数据所需的存储空间较大。以至于数据库缓存的数据行减少，查询时会去读磁盘数据产生大量的随机读IO，产生IO瓶颈。</p><p><strong>分析：</strong>可以用列表页和详情页来帮助理解。垂直分表的拆分原则是将热点数据（可能会冗余经常一起查询的数据）放在一起作为主表，非热点数据放在一起作为扩展表。这样更多的热点数据就能被缓存下来，进而减少了随机读IO。拆了之后，要想获得全部数据就需要关联两个表来取数据。但记住，千万别用join，因为join不仅会增加CPU负担并且会讲两个表耦合在一起（必须在一个数据库实例上）。关联数据，应该在业务Service层做文章，分别获取主表和扩展表数据然后用关联字段关联得到全部数据。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="三分库分表工具"><strong>三、分库分表工具</strong><a class="hash-link" href="#三分库分表工具" title="标题的直接链接">​</a></h2><ul><li><p>sharding-sphere：jar，前身是sharding-jdbc；</p></li><li><p>TDDL：jar，Taobao Distribute Data Layer；</p></li><li><p>Mycat：中间件。</p></li></ul><blockquote><p>注：工具的利弊，请自行调研，官网和社区优先。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="四分库分表步骤"><strong>四、分库分表步骤</strong><a class="hash-link" href="#四分库分表步骤" title="标题的直接链接">​</a></h2><p>根据容量（当前容量和增长量）评估分库或分表个数 -&gt; 选key（均匀）-&gt; 分表规则（hash或range等）-&gt; 执行（一般双写）-&gt; 扩容问题（尽量减少数据的移动）。<strong>五、分库分表问题</strong></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1非partition-key的查询问题">1、非partition key的查询问题<a class="hash-link" href="#1非partition-key的查询问题" title="标题的直接链接">​</a></h3><p>基于水平分库分表，拆分策略为常用的hash法。<strong>端上除了partition key只有一个非partition key作为条件查询</strong>映射法</p><p><img loading="lazy" alt="Untitled" src="/assets/images/d45d1c5b0e186de1-e9744be3b4f6cffd2c0da139c46c8a24.png" width="510" height="288" class="img_ev3q"></p><p>基因法</p><p><img loading="lazy" alt="Untitled" src="/assets/images/6fb78ce24ebb2c49-d2fb2a79630a2e47a74e67c2303027ab.png" width="718" height="292" class="img_ev3q"></p><blockquote><p>注：写入时，基因法生成user_id，如图。关于xbit基因，例如要分8张表，23=8，故x取3，即3bit基因。根据user_id查询时可直接取模路由到对应的分库或分表。根据user_name查询时，先通过user_name_code生成函数生成user_name_code再对其取模路由到对应的分库或分表。id生成常用snowflake算法。</p></blockquote><p><strong>端上除了partition key不止一个非partition key作为条件查询</strong></p><p>映射法</p><p><img loading="lazy" alt="Untitled" src="/assets/images/54167f640ef4ea16-6d97fa218a6246d08bf6883f47a99467.png" width="567" height="288" class="img_ev3q"></p><p>冗余法</p><p><img loading="lazy" alt="Untitled" src="/assets/images/d0dd801bcec81b17-2eaa0b35588c4a4f0ee3b9c159e93704.png" width="730" height="372" class="img_ev3q"></p><blockquote><p>注：按照order_id或buyer_id查询时路由到db_o_buyer库中，按照seller_id查询时路由到db_o_seller库中。感觉有点本末倒置！有其他好的办法吗？改变技术栈呢？</p></blockquote><p><strong>后台除了partition key还有各种非partition key组合条件查询</strong></p><p>NoSQL法</p><p><img loading="lazy" alt="Untitled" src="/assets/images/2455f2db2ab5fd41-b219b8fe804b3e8d9954c4a299ae921a.png" width="363" height="349" class="img_ev3q"></p><p>冗余法</p><p><img loading="lazy" alt="Untitled" src="/assets/images/9c63a0abf1317f2e-33fce62cbb2c41c256f4b107c42ad070.png" width="433" height="351" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2非partition-key跨库跨表分页查询问题">2、非partition key跨库跨表分页查询问题<a class="hash-link" href="#2非partition-key跨库跨表分页查询问题" title="标题的直接链接">​</a></h3><p>基于水平分库分表，拆分策略为常用的hash法。</p><blockquote><p>注：用NoSQL法解决（ES等）。</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3扩容问题">3、扩容问题<a class="hash-link" href="#3扩容问题" title="标题的直接链接">​</a></h3><p>基于水平分库分表，拆分策略为常用的hash法。<strong>水平扩容库（升级从库法）</strong></p><p><img loading="lazy" alt="Untitled" src="/assets/images/42ecceaf9c6f14e3-5acbf8ee71da1c2986bd242c0b3fad1a.png" width="654" height="989" class="img_ev3q"></p><blockquote><p>注：扩容是成倍的。</p></blockquote><p><strong>水平扩容表（双写迁移法）</strong></p><p><a href="http://www.17bigdata.com/wp-content/uploads/2022/10/mysql%EF%BC%9A%E4%BA%92%E8%81%94%E7%BD%91%E5%85%AC%E5%8F%B8%E5%B8%B8%E7%94%A8%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E6%96%B9%E6%A1%88%E6%B1%87%E6%80%BB%EF%BC%81-11.png" target="_blank" rel="noopener noreferrer">第一步：（同步双写）修改应用配置和代码，加上双写，部署；</a></p><p><img loading="lazy" alt="Untitled" src="/assets/images/0f99b91c74a5aa60-13977ecf25326c25b73cc5e20f803de2.png" width="734" height="327" class="img_ev3q"></p><ul><li><p>第二步：（同步双写）将老库中的老数据复制到新库中；</p></li><li><p>第三步：（同步双写）以老库为准校对新库中的老数据；</p></li><li><p>第四步：（同步双写）修改应用配置和代码，去掉双写，部署；</p></li></ul><blockquote><p>注：双写是通用方案。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="六分库分表总结">六、分库分表总结<a class="hash-link" href="#六分库分表总结" title="标题的直接链接">​</a></h2><ul><li><p>分库分表，首先得知道瓶颈在哪里，然后才能合理地拆分（分库还是分表？水平还是垂直？分几个？）。且不可为了分库分表而拆分。</p></li><li><p>选key很重要，既要考虑到拆分均匀，也要考虑到非partition key的查询。</p></li><li><p>只要能满足需求，拆分规则越简单越好。</p></li></ul><br></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>标签：</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/mysql">mysql</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/分库">分库</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/分表">分表</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/science09/science09.github.io/tree/main/docs/notes/wechat/互联网公司常用分库分表方案汇总.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">最后<!-- -->由 <b>zhaofeng.luo</b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/10年后，再审视Heroku发布的十二要素应用"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">10年后，再审视Heroku发布的十二要素应用</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/resources-webtool"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">工具网站列表</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#一数据库瓶颈" class="table-of-contents__link toc-highlight">一、数据库瓶颈</a><ul><li><a href="#1io瓶颈" class="table-of-contents__link toc-highlight">1、IO瓶颈</a></li><li><a href="#2cpu瓶颈" class="table-of-contents__link toc-highlight">2、CPU瓶颈</a></li></ul></li><li><a href="#二分库分表" class="table-of-contents__link toc-highlight"><strong>二、分库分表</strong></a><ul><li><a href="#1水平分库" class="table-of-contents__link toc-highlight">1、水平分库</a></li><li><a href="#2水平分表" class="table-of-contents__link toc-highlight">2、水平分表</a></li><li><a href="#3垂直分库" class="table-of-contents__link toc-highlight">3、垂直分库</a></li><li><a href="#4垂直分表" class="table-of-contents__link toc-highlight">4、垂直分表</a></li></ul></li><li><a href="#三分库分表工具" class="table-of-contents__link toc-highlight"><strong>三、分库分表工具</strong></a></li><li><a href="#四分库分表步骤" class="table-of-contents__link toc-highlight"><strong>四、分库分表步骤</strong></a><ul><li><a href="#1非partition-key的查询问题" class="table-of-contents__link toc-highlight">1、非partition key的查询问题</a></li><li><a href="#2非partition-key跨库跨表分页查询问题" class="table-of-contents__link toc-highlight">2、非partition key跨库跨表分页查询问题</a></li><li><a href="#3扩容问题" class="table-of-contents__link toc-highlight">3、扩容问题</a></li></ul></li><li><a href="#六分库分表总结" class="table-of-contents__link toc-highlight">六、分库分表总结</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">本站</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">个人笔记</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/notes-intro">技术文摘</a></li></ul></div><div class="col footer__col"><div class="footer__title">我的</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/science09" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/">...</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?d8e6c589e01c3df834c9a1f32e0f9258";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
        
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>  版权所有 © 2022  此网站使用 Docusaurus 构建。</div></div></div></footer></div>
<script src="/assets/js/runtime~main.b8772c3e.js"></script>
<script src="/assets/js/main.6900f799.js"></script>
</body>
</html>