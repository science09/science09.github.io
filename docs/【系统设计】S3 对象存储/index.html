<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-notes/wechat/【系统设计】S3 对象存储">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">【系统设计】S3 对象存储 | 彼岸_未来</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://science09.github.io/docs/【系统设计】S3 对象存储"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="【系统设计】S3 对象存储 | 彼岸_未来"><meta data-rh="true" name="description" content="在本文中，我们设计了一个类似于 Amazon Simple Storage Service (S3) 的对象存储服务。S3 是 Amazon Web Services (AWS) 提供的一项服务， 它通过基于 RESTful API 的接口提供对象存储。根据亚马逊的报告，到 2021 年，有超过 100 万亿个对象存储在 S3 中。"><meta data-rh="true" property="og:description" content="在本文中，我们设计了一个类似于 Amazon Simple Storage Service (S3) 的对象存储服务。S3 是 Amazon Web Services (AWS) 提供的一项服务， 它通过基于 RESTful API 的接口提供对象存储。根据亚马逊的报告，到 2021 年，有超过 100 万亿个对象存储在 S3 中。"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://science09.github.io/docs/【系统设计】S3 对象存储"><link data-rh="true" rel="alternate" href="https://science09.github.io/docs/【系统设计】S3 对象存储" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://science09.github.io/docs/【系统设计】S3 对象存储" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="彼岸_未来 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="彼岸_未来 Atom Feed"><link rel="stylesheet" href="/assets/css/styles.e07c85a0.css">
<link rel="preload" href="/assets/js/runtime~main.164e32a3.js" as="script">
<link rel="preload" href="/assets/js/main.520d6ac8.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a href="#" class="skipToContent_fXgn">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA" style="border-radius:70%"><img src="/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU" style="border-radius:70%"></div><b class="navbar__title text--truncate">彼岸_未来</b></a><a class="navbar__item navbar__link" href="/blog">个人笔记</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/notes-intro">技术文摘</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/science09" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/notes-intro">介绍</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/分布式唯一 ID 生成方案">公众号文章</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/分布式唯一 ID 生成方案">分布式唯一 ID 生成方案</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/how_dose_linux_filesystem_work">Linux文件系统是如何工作的？</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/mysql_MVCC_and_its_implementation_principle">深入理解 MySQL 的 MVCC 及实现原理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/从0.742秒到0.006秒，MySQL百万数据深分页优化实战">从0.742秒到0.006秒，MySQL百万数据深分页优化实战</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/30条永不过时的SQL优化技巧">30条永不过时的SQL优化技巧</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/21个MySQL表设计的经验准则">21个MySQL表设计的经验准则</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/MySQL的普通索引和唯一索引到底什么区别？">MySQL的普通索引和唯一索引到底什么区别？</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图文结合！Redis延迟队列golang高效实践">图文结合！Redis延迟队列golang高效实践</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/3种方式！Go Error处理最佳实践">3种方式！Go Error处理最佳实践</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/推荐系统 embedding 技术实践总结">推荐系统 embedding 技术实践总结</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Go几个黑魔法技巧汇总">Go几个黑魔法技巧汇总</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Redis详细介绍一篇就够">Redis详细介绍一篇就够</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/快速实现一个分布式定时器">快速实现一个分布式定时器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/如何做架构设计和评审">如何做架构设计和评审</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/面试官：为什么说mysql数据库单表最大两千万？">面试官：为什么说mysql数据库单表最大两千万？</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/【系统设计】S3 对象存储">【系统设计】S3 对象存储</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/B站在全链路压测上的实践">B站在全链路压测上的实践</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/小红书KV存储架构：万亿级数据与跨云多活不在话下">小红书KV存储架构：万亿级数据与跨云多活不在话下</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/网易严选商品中心DDD实践">网易严选商品中心DDD实践</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/社区点赞业务缓存设计优化探索 ｜ 得物技术">社区点赞业务缓存设计优化探索 ｜ 得物技术</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/docs/resources-webtool">资源</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/resources-webtool">工具网站列表</a></li></ul></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">公众号文章</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">【系统设计】S3 对象存储</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>【系统设计】S3 对象存储</h1></header><br><p>在本文中，我们设计了一个类似于 Amazon Simple Storage Service (S3) 的对象存储服务。S3 是 Amazon Web Services (AWS) 提供的一项服务， 它通过基于 RESTful API 的接口提供对象存储。根据亚马逊的报告，到 2021 年，有超过 100 万亿个对象存储在 S3 中。</p><p>在深入设计之前，有必要先回顾一下存储系统和相关的术语。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="存储系统"><strong>存储系统</strong><a class="hash-link" href="#存储系统" title="标题的直接链接">​</a></h2><p>在高层次上，存储系统分类三大类：</p><ul><li><p>块存储</p></li><li><p>文件存储</p></li><li><p>对象存储</p></li></ul><p><strong>块存储</strong></p><p>块存储最早出现在 1960 年。常见的物理存储设备，比如常说的 HDD 和 SSD 都属于块存储。块存储直接暴露出来卷或者盘，这是最灵活，最通用的存储形式。</p><p>块存储不局限于物理连接的存储，也可以通过网络、光纤和 iSCSI 行业标准协议连接到服务器。从概念上讲，网络附加块存储仍然暴露原始块，对于服务器来说，它的工作方式和使用物理连接的块存储是相同的。</p><p><strong>文件存储</strong></p><p>文件存储在块存储的上层，提供了更高级别的抽象，文件存储不需要处理管理块、格式化卷等，所以它处理文件和目录更简单，数据文件存储在分层目录结构。</p><p><strong>对象存储</strong></p><p>对象存储相对来说比较新，为了高持久性，大规模和低成本而牺牲性能，这是一个非常刻意的权衡。对象存储针对的是相对 “冷” 的数据，主要用于归档和备份。对象存储把所有的数据作为对象存储在平面结构中，没有分层的目录结构。</p><p>通常提供了 RESTful API 用来支持数据访问，和其他的存储相比，它是比较慢的，大多云服务商都提供了对象存储的产品，比如 AWS S3, Azure Blob 存储等。</p><p><strong>对比</strong></p><p><img loading="lazy" alt="Untitled" src="/assets/images/bbcb3c20fee82647-2cba80db053fc227dc835c99f6148cdd.png" width="829" height="320" class="img_ev3q"></p><p><strong>术语</strong></p><p>要设计一个类似于 S3 的对象存储，我们需要先了解一些对象存储的核心概念。</p><ul><li><p>桶 （Bucket），桶是对象的逻辑容器，存储桶名称是全局唯一的。</p></li><li><p>对象（Object），对象时我们存储在桶中的单个数据，它由对象数据和元数据组成。对象可以是我们存储的任何字节序列，元数据是一组描述对象的键值对。</p></li><li><p>版本控制 （Versioning）， 数据更新时，允许多版本共存。</p></li><li><p>统一资源标识符 (URI)，对象存储提供了 RESTful API 来访问资源，所以每个资源都有一个URI 唯一标识。</p></li><li><p>服务等级协议 (SLA)，SLA 是服务提供商和客户之间的协议。比如 AWS S3 对象存储，提供了 99.9 的可用性，以及夸张的 99.999999999% （11个9） 的数据持久性。</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="设计要求"><strong>设计要求</strong><a class="hash-link" href="#设计要求" title="标题的直接链接">​</a></h2><p>在这个面试的系统设计环节中，需要设计一个对象存储，并且要满足下面的几个要求。</p><ul><li><p>基础功能，桶管理，对象上传和下载，版本控制。</p></li><li><p>对象数据有可能是大对象（几个 GB），也可能是小对象（几十 kb）。</p></li><li><p>一年需要存储 100 PB 的数据。</p></li><li><p>服务可用性 99.99% （4个9）, 数据持久性 99.9999 % （6个 9）。</p></li><li><p>需要比较低的存储成本。</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="对象存储的特点">对象存储的特点<a class="hash-link" href="#对象存储的特点" title="标题的直接链接">​</a></h2><p>在开始设计对象存储之前，你需要了解它的下面这些特点。</p><p><strong>对象不变性</strong></p><p>对象存储和其他两种存储的主要区别是，存储对象是不可变的，允许进行删除或者完全更新，但是不能进行增量修改。</p><p><strong>键值存储</strong></p><p>我们可以使用 URI 来访问对象数据，对象的 URI 是键，对象的数据是值，如下</p><div class="language-plain codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Request:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GET /bucket1/object1.txt HTTP/1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Response:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HTTP/1.1 200 OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Length: 4567</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[4567 bytes of object data]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>写一次，读多次</strong></p><p>对象数据的访问模式是一次写入，多次读取。根据 LinkedIn 做的研究报告，95 %的请求是读取操作。</p><p>【Ambry: LinkedIn’s Scalable Geo-Distributed Object Store】</p><p><strong>支持小型和大型对象</strong></p><p>对象存储的设计理念和 UNIX 文件系统的设计理念非常相似。在 UNIX 中，当我们在本地文件系统中保存文件时，它不会把文件名和文件数据一起保存。那是怎么做的呢？它把文件名存储在 inode 的数据结构中，把文件数据存储在不同的磁盘位置。inode 包含一个文件块指针列表，这些指针指向文件数据的磁盘位置。当我们访问本地文件时，首先会获取 inode 中的元数据。然后我们按照文件块指针来读取磁盘的文件数据。</p><p>对象存储的工作方式也是如此，元数据和数据存储分离，如下</p><p><img loading="lazy" alt="Untitled" src="/assets/images/12266b147d53a0c9-65decbd13a8087ea9b2cf8b11960e6ad.png" width="777" height="429" class="img_ev3q"></p><p>看一看我们的存储桶和对象的设计</p><p><img loading="lazy" alt="Untitled" src="/assets/images/45c5c0e84229221c-6e95c864ed056b1ebd8aec8e03b00d8e.png" width="836" height="264" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="整体设计"><strong>整体设计</strong><a class="hash-link" href="#整体设计" title="标题的直接链接">​</a></h2><p>下图显示了对象存储的整体设计。</p><p><img loading="lazy" alt="Untitled" src="/assets/images/0d375c0260d1e2d0-ab6a344f1569241af8a3b537c9bf801f.png" width="823" height="445" class="img_ev3q"></p><ul><li><p>Load balancer 负载均衡，向多个 API 服务分发 RESTful API 请求。</p></li><li><p>API Service，编排身份验证服务，元数据服务和存储服务，它是无状态的，可以很好的支持水平扩展。</p></li><li><p>Identity &amp; Access Management （IAM），身份和访问管理，这是处理身份验证、授权和访问控制的服务。</p></li><li><p>Data Store 数据存储，存储和检索对象数据，所有和数据有关的操作都是基于对象 ID（UUID）。</p></li><li><p>Metadata Service 元数据服务，存储对象的元数据。</p></li></ul><p>接下来我们一起来探索对象存储中的一些重要的工作流程。</p><ul><li><p>上传对象</p></li><li><p>下载对象</p></li><li><p>版本控制</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="上传对象"><strong>上传对象</strong><a class="hash-link" href="#上传对象" title="标题的直接链接">​</a></h2><p><img loading="lazy" alt="Untitled" src="/assets/images/b514172e8fa7bbe4-878fd98cfe1dcd50f92bfea2a22e58f7.png" width="797" height="444" class="img_ev3q"></p><p>在上面的流程中，我们首先创建了一个名为 &quot;bucket-to-share&quot; 的存储桶，然后把一个名为 &quot;script.txt&quot; 的文件上传到这个桶。</p><ol><li><p>客户端发送一个创建 “bucket-to-share” 桶的 HTTP PUT 请求，经过负载均衡器转发到 API 服务。</p></li><li><p>API 服务调用 IAM 确保用户已获得授权并且有 Write 权限。</p></li><li><p>API 服务调用元数据服务，创建存储桶，并返回成功给客户端。</p></li><li><p>客户端发送创建 “script.txt” 对象的 HTTP PUT 请求。</p></li><li><p>API 服务验证用户的身份并确保用户对存储桶具有 Write 权限。</p></li><li><p>API 服务把 HTTP 请求发到到数据存储服务，完成存储后返回对象的 UUID。</p></li><li><p>调用元数据服务并创建元数据项，格式如下</p></li></ol><p><img loading="lazy" alt="Untitled" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAyQAAAB4CAYAAAADrjYVAAAgAElEQVR4Ae2dwY7ctrKG8ypeeOGXCo6RAH6NLOzFPIcBAwbmCe46QYALBwbuAwQ4Z3OQZD1rXZBSkVVkkaI06mn19BfAaEkki8WPP4ssddv5YeI/CEAAAhCAAAQgAAEIQAACVyLww5X6pVsIQAACEIAABCAAAQhAAAITCQkigAAEIAABCEAAAhCAAASuRoCE5Gro6RgCEIAABCAAAQhAAAIQICFBAxCAAAQgAAEIQAACEIDA1QiQkFwNPR1DAAIQgAAEIAABCEAAAiQkaAACEIAABCAAAQhAAAIQuBoBEpKroadjCEAAAhCAAAQgAAEIQICEBA1AAAIQgAAEIAABCEAAAlcjQEJyNfR0DAEIQAACEIAABCAAAQiQkKABCEAAAhCAAAQgAAEIQOBqBEhIroaejiEAAQhAAAIQgAAEIAABEhI0AAEIQAACEIAABCAAAQhcjQAJydXQ0zEEIAABCEAAAhCAAAQgQEKCBiAAAQhAAAIQgAAEIACBqxEgIbkaejqGAAQgAAEIQAACEIAABG4+Ifnrr78m/sAADaABNIAG0AAaQANo4GwaINUYI/AqEpKnp6eJP+dkEAIDc3POuWFemJd70AAxCJ3fg84Z4zl1HuIP/40RICEhmblowsBh4JxBks2LebkXDRCD0Pq9aJ1xnk/rJCRjyUioRUJCQkJCggYuqgE2yfNtkvc0JyQk6O+e9M5Yz6V3EhISEg5YJzlkcxg4V3Bks2I+7k0DxCA0f2+aZ7zn0TwJCQkJCQkJCRo4iQbYHM+zOd7jXJCQoL971D1jPofuSUhISDiMnuQwymHgHEGRzYl5uFcNEIPQ/r1qn3FfX/skJCQkJCQkJGjgJBpgU7z+pnjPc0BCgv7uWf+M/br6JyEhIeEwepLDKIeB6wZDNiP437sGiEGsgXtfA4z/emuAhISEhISEhAQNnEQDbIbX2wxh/xT/x7lwQINoAA1cQwMkJCQkHEZPchjl7SSbwDU2AfpEd6IBYhBaEC3wiRZeWgMkJCQkJCQkJGjgJBp46Q2A/jh0aA2QkKAHrQeu0cNLaoCEhISEw+hJDqMcBgj+Lxn86Qu9lRogBqGJUhPco4mX0gAJCQkJCQkJCRo4iQZeKvDTD4cMTwMkJOjC0wXP0MVLaICEhISEw+hJDqMcBgj6LxH06QOdtTRADEIbLW3wHG1cWgMkJCQkJCQkJGjgJBq4dMDHPoeKngZISNBHTx+UoY9LaoCEhISEw+hJDqMcBgj2lwz22EZfaxogBqGRNY1QjkYupQESEhKS3QnJv7/8PL15+2568/H3po3fPr6LdX788p9mnUuJ+9bsHn4Y+PPL9GOYn7cfp98aSdfIHB7P8ffpl+jXz9PnPxvB/dePs7b+9WX6d8P34/1q+EL/rN070cDWGHTZ+D4QJw6al/U4+J/p87/mveyXX4kTxF40cAkNkJCQkOw+bKwH8afpuA1LNoTOIfagzekSC23E5tbDwKrNF05IRA/ryefAQYOEZPe6XNXFja8Txne5w9DWGHRcfPfGNBAnulqW9u0XMqIliV3tl2uy/7ybSEi8ueKZaInP/VogISEh2X3wWQ/i+4VZL2rZXEhIajYNzgMJybCt7sY/93/o4YSEZPe6PHJOsdVYWwPr4RbZvaqE5ND4R0Jyi3rG59uKXyQkJCSdg08OwvGnWW/fTfrtt05I0nVRxzuk6rrBrn3jVPb58/T5f+WnR/NX5ms/E3vSG1G6fje9UT//KX1481YlOqnNx+m3dC1jl8TI+ymULrP9jQTGrYeBYLMahxrjJg76Z3eSDMSfVcm4c2CTORVN/PJrOWcem9z+6Uk4Kebp2dJWfNDjeaWHwBFtUEfrh+tL6WFrDJJYEPYFuTYx3VnHUk/vJU9Sb4k58zcVRZxQsTh/kyF1lr1B4kVpr9iXSn4pjqo4mJ7Ftr/zky3ib+esREwq19SeexISEpLGIisCvWwUKrDrgC2HU/mUJKPcfORe6s2fcjD1+nxOQrJsUsr30i/rx/LVvt74VNuQtPy4/I5Y2qVNtdVGbXBrC3TvYUB8SZ+yKbd8CmNa/EpzWN6bcUvS6CUeocx73vuZhMxzb96LAwabYWOdshGurSvKxzVyWAySFzySGEhMeqp/xptikI45MR7pOKFijMTUVnwL5dKvsplitRNLkg8rcTDEWNlD0NW4rmAFqxENkJCQkPgHnRTQ1cGyeJaCuLPZyIFXEpB5M9AbzLxAxUYol2v/L2HXbZsCTxuVHHjzZuZvSoXtqr2U528LZFwyzuS7bJbpjb/i52yEegzbDgPZp7xBFs+qcTypjXr2y/qdOSWbMudmkxeuNsgKE5+xrit+LnakD/WX75NfSluaFdeaJ9fo4RgNbItBObmQOPj0lGNIjAOyttU6tnFCYkGOrXkupezn6fOX+h+5SDGiFXNT/FuPwdZWMYYYt8UXEpI8P8doDntwFA2QkJCQuAmJDdDLgikCvFenfGY2n9S+/uYibF6mbnV4lw3BPwyLoONn6idvRGJbNs50r96gpZ9tVe3zBiUH9dY407cUyW72wfhYje9p2nQYqHwMc1T46dUpntlxCON6fgI3W7cOosJ0a0Li2nUOMmv8KK/nBCYw2aKBTTHI+bYj9GXigLOOTXkRj6yvdTzSsUXsNGNu17bVhY1B0q/ea4rY6sRv67u1Txk80MC6BkhISEjchCR/5a0O1LK5LG+yUxBPb79y0JaNQzaNeJ82CB3os0hre+GN/pfln4b1Nonc1iz21E/2XfyICYmUy5s1uZefGaR7aZ/HtZqQiM0dG9a2w4Dw0G/simdpHJl3yTjdR7+L9uUYivmPzP/8Mn1e/hlMYSxzb+bE2JJ+Zr+SD+obErGl/95P215DB6ZP6sAPDaxpYFsMysmHvOjJfz9siUtVzJC1L9+I5HuJrfHFypfwT8lL2c/T51/l7xHmWJZiRCvmpvgncbw9/ykGFXEwxbJkS8fbtr01zpTDDg3UGiAhISHxE5K0GdRvyyVIpyCevg2QuvWmIW3SJqLbSEKjgn5+6yW2ZHNa+mhtQuEQmuzkjSj1G9qlcvFXPpe+Urm0X09IWjbzJlsvvjIg7T4MaJbhustzHqvMR5rDhWe6NzaFQzEHSx0ZY2Icn0sbb9xip+Qt86A+ZSwkF4116vHlWbm2uB/TxGExSF4upFgqazr/PTyJQTZuLPVMYjDHiVRPYkJle24r8aiMydKfp4UU95Y4mPoycbCwT0wiJqGBQzVAQkJC0hFUPohLgpCCvf4Xnj7+nr6mD/V0HQnsejOQZ2IzHaDj4pbDqmxg+WCbNo2wSSwbh7e55I0ot019VhtO2Oykz/KALO0zBxlb8kX74WyQUt/1swhmWw8DwWbyQzZO15+P02/pTaVll9qrdumZ2JTDRfQ3s5jnb2EWysz4hZ13ECp4h7bav3DgkHs5fBSsRnhSx2PPM3TR1sDWGCRx9ccv+V+hSj99XdasjidhH8ht8v8sV9cJcWXeL8o4Iff9ly465kpf2aY/9tR/ioM2zul/uEPbR0s+T7jAZY8GSEhISDoJyXMXVQ7qBPF1llsPA3sWfNlGNmydMJZ1uF+fOxjB6DVo4Box6DVwYwysfzTwfA2QkJCQXCQhSW+c4lv23tvyvSJWb8vSm3z15uwG36i/6GFAvoGI7NS3HAdyk2QnfRN2wb7YDPauI9qhnayBF41BB8aaoTk03+DKN/D2G+MhOy/tN/1d5IzCXOd1fxYWJCQkJBdZ7Doh4duRsYX/oocBlZDw7cjY/JwlaOMH83UpDbxoDOKgfZG991LawC5x59IaICEhISEonmRj5DBAwL90wMc+GutpgBiEPnr6oAx9XFIDJCQkJCQkJCRo4CQauGSwxzaHiTUNkJCgkTWNUI5GLqUBEhISEg6jJzmMchgg0F8q0GMXbY1ogBiETkZ0Qh10cgkNkJCQkJCQkJCggZNo4BJBHpscHkY1QEKCVka1Qj20crQGSEhISDiMnuQwymGAAH90gMcemtqiAWIQetmiF+qilyM1QEJCQkJCQkKCBk6igSODO7Y4LGzVAAkJmtmqGeqjmaM0QEJCQsJh9CSHUQ4DBPajAjt20NIeDRCD0M0e3dAG3RyhARISEhISEhISNHASDRwR1LHB4WCvBkhI0M5e7dAO7TxXAyQkJCQcRk9yGOUwQEB/bkCnPRp6jgaIQejnOfqhLfp5jgZISEhISEhISNDASTTwnGBOWw4Dz9UACQkaeq6GaI+G9mqAhISEhMPoSQ6jHAYI5HsDOe3QzhEaIAahoyN0hA10tEcDJCQkJCQkJCRo4CQa2BPEacPmf5QGSEjQ0lFawg5a2qoBEhISEg6jJzmMchgggG8N4NRHM0dqgBiEno7UE7bQ0xYNkJDcWUISJpw/MEADaAANoAE0gAbQABo4kwbGj+T3XfOHWx9+EB3/nZcA83PeucEzCNwDAWLQPcwyY4TAOQkQf8bnhYRknBU1dxBgMe6ARhMIQOAwAsSgw1BiCAIQ2EiA+DMOjIRknBU1dxBgMe6ARhMIQOAwAsSgw1BiCAIQ2EiA+DMOjIRknBU1dxBgMe6ARhMIQOAwAsSgw1BiCAIQ2EiA+DMOjIRknBU1dxBgMe6ARhMIQOAwAsSgw1BiCAIQ2EiA+DMOjIRknBU1dxBgMe6ARhMIQOAwAsSgw1BiCAIQ2EiA+DMOjIRknBU1dxBgMe6ARhMIQOAwAsSgw1BiCAIQ2EiA+DMOjIRknBU1dxBgMe6ARhMIQOAwAsSgw1BiCAIQ2EiA+DMOjIRknBU1dxBgMe6ARhMIQOAwAsSgw1BiCAIQ2EiA+DMOjIRknBU1dxBgMe6ARhMIQOAwAsSgw1BiCAIQ2EiA+DMOjIRknBU1dxBgMe6ARhMIQOAwAsSgw1BiCAIQ2EiA+DMOjIRknBU1dxBgMe6ARhMIQOAwAsSgw1BiCAIQ2EiA+DMOjIRknBU1dxBgMe6ARhMIQOAwAsSgw1BiCAIQ2EiA+DMOjIRknBU1dxBgMe6ARhMIQOAwAsSgw1BiCAIQ2EiA+DMOjIRknBU1dxBgMe6ARhMIQOAwAsSgw1BiCAIQ2EiA+DMOjIRknBU1dxBgMe6ARhMIQOAwAsSgw1BiCAIQ2EiA+DMOjIRknFWq+cfDu+nNw/d0z0WbwPbF+H369Pbd9Eb+FJwjeyl7+2H6+l/btyk3bf+Zvv6k7IoNU2e29ffjh9x/rPcw/aG6MX389Dj9rcri5X8fp/dif5OPpaHl/tuD8sf6Mk12XO8f/1FGbFlkqsdr7L6bPn1TTTuXhk81fjt/xmbRX+XPNE2Grfa14U/fl6VRmI/KT2VwmS/tq/FjmUtdrloXlzVzPSfGbmt8F/G3My/LCAJL7Wt83Jszr8zRuwYUx2/mouBlygo9OGtR225db49BRb+FT0ZzzfEu42rNcXR2pM7si9VewSxwKXycirkx7U18WmJi2b6AaXRbroeirzcFE8Or6mddl4Ur9jb2bfcB05+jGTOWan62+2PsOf2Vc2H4DM/FmFYMHC+OVHOlzzJ27CE+V/EgdODZTR2P+Nmp0/XP0b2av3oe5j2t1kOh+W6faWDzuN+O75PSck/8kbb39klC8gIzHheEWjhll2EhuQu/rDhN05otp8lVH21djH8/PqgkYw5Amc336ZPiGFmoDS4GJFVuuc62zMacDvP2kG/bWXxrfc6bj90gs4VOIM6V7FXcsLK9fv/zhpLHGO5zW2v4n+nrg0qmin5sXXUXg3fmZZkX81XaDG3VfCmrU0qs1PzZcueu68tcP/rnHdiUOamTuc2HwKw7Vbl3GcdbruXM2bLy+xBf2pzyYXnY38UvXd8OIx9EqjH35swri3NSMlh6W/wwY/v2YBLhNUZluR2Hf7c9Bn0wOrV92hg0r/e8HpIHgcPDw/TprVMmldbqCK/qEFTGsmLdhbjWW9vRbscv8U99BgaVNpby3p5Uxitbd0u8Us6kyyWeFjGu56udy3INFhwjp1b8TE7ElyiaTdmHHXNuF69G52JZV6MvQqMPXtwLdloxeMCXpl0Z1pqmQ71enZ5/U28/K+dSHPI+i/XT7TO3l7G342iuq6+2xh/d9t6uSUheYMa7AWl5K6wDWs+lNVu9ttcoe/Zi7AULE0CdYGXKiyCkYIRAo/mH+1bQKevG4JoCfLuP2F1vLMoffVnPtx6nvp5b2fqhfPzgUY1NO7JcV3U0Y33t1e+Nv1fm+BEedX2Rb1tCgtOzHXz+6WH69JOd88p2w4f8OLC2NnJZuKrnKr5pVPMT+owHjoP97Y8l++3W6/nSKnN0EAgE+58eOgeiUKloW/nU6tPCNndbY9C2Pv01H8f6zdGo8qxbJ3IIh2HPfv3MrnvVyXJpxlQwrmvXT0z7ojj0reNnLq79NOvAmcu1cWTb+mBrkwbhaurGm5U16HDpjVvsV3WKcbX51HoXm/YzcPwwfXr4MPTLjOBPM44Uvpl+wvjTXmZK4k3X7lI91Al7Z8VEmevW6fkXY2h7P+v1qbqv94Nun0vLyKbeJ4zdxs3W+NMwcxeP7y4hiQEvfq0avraz4g6CTj8VkrJFrF+XsrDYbNCUIDdv7HP7HCCtzfLAMgfs3Gdolw8IswKXOg/f4yLPdUtb59TrcxejZW3HaAOQzIOuo595m+NS1wSkTr1QPdQVbZSH4oGA3kp0tNf52vcljdv4vbTSm6q+zkYbV35ftrLmKSW5nTtX2kd9Lc2XzzCmbWz6vhjzzX7Fd/nMrRLj/Kh/1exDmnn+es8WjbkHA/FTPsV27wAQ+rBxLreyV+6Ye+NqltX+paSw2WbxpSi3Pjl27RDcu80xKPigmFkfyi68OVTMi/Hk1iN1Qm1vzOUzz4fcU2VjU1yY7fQYtMtKP4vxeGy8Z3oo6VrGLJ9S4PUpZWXd8Dw/W41fYqb4tOOv+7flReOBuRC/5LOw0L71WHrPxEKvTOqEz2a9wHKJNXvrNNutJ29dzsn/en7a45FG0kY+5fnY5+b4M2b2Vda6r4SkXPzfvqe/GxDErL8O/fvxcS4LC6R482kDQ1iERXIT2+RDgK1f66haSNrPYoGu2aqtX/fJ8xbjzNYcVJf5KOckjLKew/B3QSQ57AQTzTv9jEuSU2mvOCofzJvB8LxMHNNPkEL/H6av3/p/v0T10jiMqMNnoY3YVo8lXss4nN+Z687imLJmdVG+zpt3fpa5utrUPurrbGAZ51Y2fV+M+Ua/2d88BmkXtZReXBTrWyqpz2xLPSwu+/pUlY/0N2jgp8fpD/33otxkR+lKuTIn4EpDOhY2/AzNbUxTc9VpIwdnvaaqeUjrSTvZv94Vg4Kfy/xrf8qe4ryXPEPb5Kcau248UifWr7UpnMS/8NnzcZ5DtbbLuLDWvppPPZAl7qq1ouN1xWfhOtcJbPSLiHmszZ8UqW6zvkq+i43kj43fvTXoruHgbzm/yo9wuabRslzzmb8RtOvLzKWK565/hS/m1vPdeyaNlrlJukoalgrLZ8tGeJ7alPOi2vbqlD5ofZS6LeYla6LwV996vvf6ND+T99aiNu5f74o/vqlX//QOExIboOIMq0VfzbgjYBsYvIVnhWvrVz0Um/dcPi+ux+rvAKzZqq1f98n+xThvViY4F0OJgd4EJbsZvX/U/OycGFNr85+SmvLbseVefFgCW95w5j7nMSy+Sd3gQKyvDgrGqXDj+5wCr6PN8icv2mTNaymNfjjrQjeO132tu9rUPsZ+7OY7s9rDpu+LcV37IAVmzmvOibHUX/l0x161WcaZDrpan6rykf4um7heR1EH6VCQ+3XH7PkiTTpl2pa+br+NXNgUfpm2cjjQa0h86XxujUHlXMZ7p8/4XN4Ip/5HtDRSRwzWdb24EDjlw6C0lRhTrG2jfVW3cxntp0N+J0Ff9JZjYHFgf3iM/7hIKl/qz4fgD9PXx/UEwGrIiwNqIEGjKn4LOzl06z2inPdopaNx6WWTRks+3bmwc+/6J054n57vkYcXg0sDc99NTVXrwfoarJVchH2ae6+O53Pp2nIfNan8GNFoqKP7j6Z6fZr5qcfYcM083hp/TOM7u7mvhCRMrgqASZg9QTplNjD4AVEL39avFRbq6gPDXCPYrZ+v2aqtX/fJrsUYmJtNpDWGlQAxGkycOdY95vnx5jr4sGz4np30zPNVPVO6jJtlPJipcuVQ0layrQqDHRWkVYn5eYI8D7bcN4CuP/3xu9oMPsoh0/M3OuKNUz3b4YuML35W/c5rK61/J/HLc24sLQzVhi6sqz7Kds59HJeTkFa2nuGv14f3zDscBJcrX9Q4mmV57qImhFHL3jK/eT5yH/U8BNvFATtXd6+2xaC+xucO5vElXetel7HIgTd/qnkeqZNsZpbpkaPX+adHqg95c6/Zi4HG/IfiOF8q8ZA5qedBjNWfbhxI1Ty+qdD8HNr1Jfqu579vL1ju+q5YuH4HjS/xK9jJ85l9qO33NWr6Uf1nCvNV7E9ip8yNum/5k+x469N7lhoUFy3fPBuxruYj10qTI3U824Vb+dbOfT0PueZ8Feorf6S42WeorxMYby2KkfbntvjTtnMPJfeXkKRZVWJrLbxQ1xGrCSjqN6jJdLFh2Pq5llx5Cym0ef/wML0vFtCaLbF5ls/Ni9Hh3R5LP0BYVq26ree51zA/88ZsA+BcI7RfNqego/IAoMaT7Yjtsb5tsqp8cHRrxyz9yGdomwOypzup6X86/mof1FilvenDKdf15PAzP3P6ksrx0ynXvui6Zb/hXh26zLU6fFju2qB3rebFK3aeNefqUH/tnEc3GpzMXIm/pS/yPHy2ytLzeY4M38RdrRmlSW0+XNc+bee8LQZ59sM45ADq6E457c+pbTNSJ5u0befnzrNiTmtu2WLvW1RVy1x27Zmac1LTXDtJG0WjeOuMq6gW2SUNyaF3/mz1GXy3sSUbNXPh+DYy7rqOpyHbZ/K1mLdcK9iw48vrKMfwXN+5csbTXLNO86iTcj8L9Ry7hmOyZedzpI5nO5mrLgKjzKKeh6JB8FsldKnUGU8sC89bc+DZSQbtxbb4Y9ve2919JSTmn5jUi2W+1mI1f4ekWJR2YS2BQwk0lqs2tv6yoHsLSS2Qsm15f3bBbluMek6ckZn5k7d5OSCZFjHQyyEilHi267kLbxq/6v+XRwxKuY8Q9KxO9D8ROveRNpulz3Rf2IrBV+nA+C83xThKbVl/5vGkzffbo/onlJefTohOmxuhdNz4LMZg+y/GX/je3WwKu0NsijbWF+V/qKfWoypZLmttBFtp3uoG7pM4N+aNWqhW/BOs0rJkI8/D58H+llzKe+naHXPPF6dsZqDXnVhfPos2bp+qSVle6l9VbV5ui0HFOpE306Kfwn/baa0jKY9+x7U3UkdahU+vfv3MzOna2l4r190v1+U85Cr/TF8f1f+Tq6fr+PJuJTkQzrmDlasQ87Te+vHbGKt8nbmmdV+Vm9bppmRjNbrCZ8NcZA2lrvsXnla9Z4uVdOaJ9wUL3VNlo9ajVM8+j9RZiX29/cx9eSFezJ/lPKXSajyppLhoj6GoaG63xh/T+M5u7ishiYs/v3VIgSdO+iy2lBFLYHTEmhdZaLgExPDb15RN5wPsrKfl4CuHlWBTH0STXx+mr/83/6XndKhcNqR8CC5snVyw2xZjMQeJ57LhJE4yh5ZznJeyTeLj2dYbmVTMfOf5tH2EWnHzT/2U5bYfqzFJRn3/xYPqM+plaSO6TJVsf1k3ZV82kdI/Xcy6bfx8K/U1XxjOkuCkOppfwddZS6lZuNDj1OvDVLI3fV+Wumv9Ooc+O8cz+2ourSvzXaXRfAAzvppDVGHoAv6a8VRzNvfvbthmTgoNemUN22mExdiMX2lNZWZ1ebnekuXmxbYYlFnkdaH69MYc/A7jjmWqrvYo6uLD9PV/itjv1TH/s9d5fZt1LXuC4mUSbkeDcSwSO9zyht+Lf642YpmNP9VPbQte3XGIf5rJ6nWINzrO6PgT9GrHtb4GdXttt+1IX6MrfDbMRfR9bX1pN4u1Fou8Z0sby6bzQqa0EefYck5ubNV9tLXEGdG36KIsK1i0NRq8CfPQmM/SbuhX+kwDERs5Npmizs2e+NMx96qL7ishuchUlgHxIp3crFEW481OHY5D4FUQIAa9imlkEBC4SQLEn/FpIyEZZ9WoSULSABMfsxh7dCiDAAQuTYAYdGnC2IcABFoEiD8tMvVzEpKaycYnJCQ9YCzGHh3KIACBSxMgBl2aMPYhAIEWAeJPi0z9nISkZsKTAwmwGA+EiSkIQGAzAWLQZmQ0gAAEDiJA/BkHSUIyzoqaOwiwGHdAowkEIHAYAWLQYSgxBAEIbCRA/BkHRkIyzoqaOwiwGHdAowkEIHAYAWLQYSgxBAEIbCRA/BkHRkIyzoqaOwiwGHdAowkEIHAYAWLQYSgxBAEIbCRA/BkHRkIyzoqaOwiwGHdAowkEIHAYAWLQYSgxBAEIbCRA/BkHRkIyzoqaOwiwGHdAowkEIHAYAWLQYSgxBAEIbCRA/BkHRkIyzoqaOwiwGHdAowkEIHAYAWLQYSgxBAEIbCRA/BkHRkIyzoqaOwiwGHdAowkEIHAYAWLQYSgxBAEIbCRA/BkHRkIyzoqaOwiwGHdAowkEIHAYAWLQYSgxBAEIbCRA/BkHRkIyzoqaOwiwGHdAowkEIHAYAWLQYSgxBAEIbCRA/BkHRkIyzoqaOwiwGHdAowkEIHAYAWLQYSgxBAEIbCRA/BkHRkIyzoqaOwiwGHdAowkEIHAYAWLQYSgxBAEIbCRA/BkHRkIyzoqaOwiwGHdAowkEIHAYAWLQYSgxBAEIbCRA/BkH9ioSkjDh/IEBGkADaAANoAE0gAbQwJk0MH4kv++aN5+Q3Pf0MXoIQAACEIAABCAAAQjcNgESktueP7yHAAQgAAEIQAACEIDATU3MM1wAAAFKSURBVBMgIbnp6cN5CEAAAhCAAAQgAAEI3DYBEpLbnj+8hwAEIAABCEAAAhCAwE0TICG56enDeQhAAAIQgAAEIAABCNw2ARKS254/vIcABCAAAQhAAAIQgMBNEyAhuenpw3kIQAACEIAABCAAAQjcNgESktueP7yHAAQgAAEIQAACEIDATRMgIbnp6cN5CEAAAhCAAAQgAAEI3DYBEpLbnj+8hwAEIAABCEAAAhCAwE0TICG56enDeQhAAAIQgAAEIAABCNw2ARKS254/vIcABCAAAQhAAAIQgMBNEyAhuenpw3kIQAACEIAABCAAAQjcNgESktueP7yHAAQgAAEIQAACEIDATRMgIbnp6cN5CEAAAhCAAAQgAAEI3DYBEpLbnj+8hwAEIAABCEAAAhCAwE0TICG56enDeQhAAAIQgAAEIAABCNw2gf8H54ffMMkggRoAAAAASUVORK5CYII=" width="804" height="120" class="img_ev3q"></p><p>上传数据的 Http 请求示例如下:</p><p><img loading="lazy" alt="Untitled" src="/assets/images/6bf99ef47da8b85d-56fa599324430fe5e02ad925a4403818.png" width="794" height="258" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="下载对象"><strong>下载对象</strong><a class="hash-link" href="#下载对象" title="标题的直接链接">​</a></h2><p>存储对象可以通过 HTTP GET 请求进行下载，示例如下</p><p><img loading="lazy" alt="Untitled" src="data:image/png;base64,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" width="858" height="149" class="img_ev3q"></p><p><strong>下载流程图</strong></p><p><img loading="lazy" alt="Untitled" src="/assets/images/327ef621a379a1f6-17eed156b1e738bda8b86a1ae4bf865b.png" width="897" height="452" class="img_ev3q"></p><ol><li><p>客户端发送 GET 请求，GET /bucket-to-share/script.txt</p></li><li><p>API 服务查询 IAM 验证用户是否有对应桶的读取权限。</p></li><li><p>验证后，API 服务会从元数据服务中获取对象的 UUID。</p></li><li><p>通过 对象的 UUID 从数据存储中获取相应的对象。</p></li><li><p>API 服务返回对象给客户端。</p></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="深入设计"><strong>深入设计</strong><a class="hash-link" href="#深入设计" title="标题的直接链接">​</a></h2><p>接下来，我们会讨论下面几个比较重要的部分。</p><ul><li><p>数据一致性</p></li><li><p>元数据</p></li><li><p>版本控制</p></li><li><p>优化大文件的上传</p></li><li><p>垃圾收集 GC</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="数据一致性"><strong>数据一致性</strong><a class="hash-link" href="#数据一致性" title="标题的直接链接">​</a></h2><p>对象数据只存放在单个节点肯定是不行的，为了保证高可用，需要把数据复制到多个节点。这种情况下，我们需要考虑到一致性和性能问题。</p><p><img loading="lazy" alt="Untitled" src="/assets/images/c7d517271ed75ab3-5dea3e92e65e46760bc8aac90cb7e1a6.png" width="808" height="533" class="img_ev3q"></p><p>保证强一致性就要牺牲性能，如果性能要求比较高时，可以选择弱一致性。鱼和熊掌不可兼得。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="数据存储方式">数据存储方式<a class="hash-link" href="#数据存储方式" title="标题的直接链接">​</a></h2><p>对于数据存储，一个简单的方式是把每个对象都存储在一个独立的文件中，这样当然是可以的。但是，当有大量的小型文件时，会有下面两个问题。</p><p>第一个问题是，会浪费很多数据块。文件系统把文件存储在磁盘块中，磁盘块的大小在卷初始化的时候就固定了，一般是 4 kb。所以，对于小于 4kb 的文件，它也会占满整个磁盘块。如果文件系统中保存了大量的小文件，那就会就会有很多浪费。</p><p>第二个问题是，系统的 inode 容量是有限的。文件系统把文件元数据存储在 inode 特殊类型的磁盘块中。对于大多数文件系统，inode 的数量在磁盘初始化时是固定的。所以有大量的文件时，要考虑到 inode 容量满的问题。</p><p>为了解决这个问题，我们可以把很多小文件合并到一个更大的文件中。从概念上讲，类似于预写日志（WAL）。当我们保存一个对象时，它被附加到一个现有的文件中。文件大小达到一定值（比如说 1 GB）后，创建一个新的文件来存储对象，下图解释了它的工作流程。</p><p><img loading="lazy" alt="Untitled" src="/assets/images/e170b43489c24cae-f8ee577d6b7c5f840ef6dbdc68e94950.png" width="744" height="437" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="数据持久性"><strong>数据持久性</strong><a class="hash-link" href="#数据持久性" title="标题的直接链接">​</a></h2><p>对存储系统来说，数据持久性非常重要，如何设计出一个 6 个 9 (99.9999%) 持久性 的存储系统？</p><p><strong>硬件故障和故障域</strong></p><p>无论使用哪种存储，硬件故障都是不可避免的。所以为了数据持久性，需要把数据复制到多个硬盘中。</p><p>假设硬盘的年故障率是 0.81 %, 当然不同的型号和品牌这些是不一样的，那个我们需要三个数据副本，1-(0.0081)^3=~0.999999, 才可以满足要求。</p><p>另外，我们还需要考虑到不同故障域的影响。这样可以在极端情况下，带来更好的可靠性，比如大规模停电，自然灾害等。</p><p><img loading="lazy" alt="Untitled" src="/assets/images/63732eabc9a8e652-c9cb2ab6b434e74f95e295369391ae4f.png" width="898" height="581" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="erasure-coding-纠删码">Erasure Coding 纠删码<a class="hash-link" href="#erasure-coding-纠删码" title="标题的直接链接">​</a></h2><p>上面提到，我们用三个完整的数据副本可以提供大概 6 个 9 的数据持久性，但是，这样的成本太高了。</p><p>还能不能优化呢？我们可以使用纠删码技术，它的原理其实很简单，假设现在有 a 和 b 两条数据，进行异或 （XOR）运算后得到 c，a ^ b = c , 而 b = c ^ a，a = c ^ b，所以这三条数据丢失任意一条数据，都可以通过剩余两条数据计算出丢失数据。</p><p>下面是一个 4 +2 纠删码的例子。</p><p><img loading="lazy" alt="Untitled" src="/assets/images/02baa609451db133-7a4956dad0b4117745e3e5af37270c23.png" width="776" height="534" class="img_ev3q"></p><ol><li><p>数据被分成四个大小均匀的数据块 d1、d2、d3 和 d4。</p></li><li><p>使用 Reed-Solomon 数学公式计算校验块，比如 <code>p1 = d1 + 2*d2 - d3 + 4*d4 p2 = -d1 + 5*d2 + d3 - 3*d4</code></p></li><li><p>节点崩溃，导致数据 d3 和 d4 丢失。</p></li><li><p>通过数据公式和现有数据，计算出丢失的数据并恢复。<code>d3 = 3*p1 + 4*p2 + d1 - 26*d2d4 = p1 + p2 - 7*d2</code></p></li></ol><p>和多副本复制相比，纠删码占用的存储空间更少。但是，在进行丢失数据恢复时，它需要先根据现有数据计算出丢失数据，这也消耗了 CPU 资源。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="数据完整性校验">数据完整性校验<a class="hash-link" href="#数据完整性校验" title="标题的直接链接">​</a></h2><p>纠删码技术在保证数据持久性的同时，也降低的存储成本。接下来，我们可以继续解决下一个难题：数据损坏。</p><p>我们可以给数据通过 Checksum 算法计算出校验和。常见的 checksum 算法有 MD5, SHA1 等。</p><p><img loading="lazy" alt="Untitled" src="data:image/png;base64,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" width="761" height="185" class="img_ev3q"></p><p>当需要验证数据时，只需要对比校验和即可，如果不一致，说明文件数据发生了改变。</p><p>我们同样可以把校验和添加到存储系统中，对于读写文件，每个对象都计算校验和，而对于只读文件，只需要在文件的末尾添加上整个文件的校验和即可。</p><p><img loading="lazy" alt="Untitled" src="/assets/images/ee21512267c8bf7b-ae56dad0226db93eeffb28ecd85965a7.png" width="734" height="512" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="版本控制"><strong>版本控制</strong><a class="hash-link" href="#版本控制" title="标题的直接链接">​</a></h2><p>版本控制可以让一个对象的多个版本同时保存在存储桶中。这样的好处是，我们可以恢复意外删除或者覆盖的对象。</p><p>为了支持版本控制，元数据存储的列表中需要有一个 object_version 的列。上传对象文件时，不是直接覆盖现有的记录，而是插入一个新记录。</p><p><img loading="lazy" alt="Untitled" src="/assets/images/8b78ea4ae2415984-f20042e9a3961d2a19abaf7ab3c2de72.png" width="945" height="405" class="img_ev3q"></p><p>当进行对象删除的时候，不需要删除这条记录，而是添加一个删除标记即可，然后等垃圾收集器自动处理它。</p><p><img loading="lazy" alt="Untitled" src="/assets/images/9220e6d32ea3f8a5-0ae65351d712c096145a02265ddc0cb8.png" width="968" height="477" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="优化大文件上传"><strong>优化大文件上传</strong><a class="hash-link" href="#优化大文件上传" title="标题的直接链接">​</a></h2><p>对于比较大的对象文件（可能有几个 GB），上传可能需要较长的时间。如果在上传过程中网络连接失败，就要重新进行上传了。</p><p>为了解决这个问题，我们可以使用分段上传，上传失败时可以快速恢复。</p><p><img loading="lazy" alt="Untitled" src="/assets/images/1947c9b55e9c7b20-7174aaa6eecb7abaa7a6394034c50cc0.png" width="669" height="640" class="img_ev3q"></p><ol><li><p>客户端调用对象存储服务发起分段上传请求。</p></li><li><p>数据存储服务返回一个唯一的 uploadID。</p></li><li><p>客户端把大文件拆分为小对象并开始上传，假设文件大小是 1.6 GB, 每个部分的大小是 200 MB, 客户端上传第一部分和 uploadID 。</p></li><li><p>上传第一部分后，数据存储服务会返回一个 ETag，本质上它是第一部分的 md5 校验和，客户端通过它来判断数据是否发生了更改，如果是则重新上传。</p></li><li><p>当每个部分都上传成功后，客户端发送一个分段上传成功的请求。</p></li><li><p>数据存储服务组装小对象为大文件，并返回一个成功消息。</p></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="垃圾收集-gc">垃圾收集 GC<a class="hash-link" href="#垃圾收集-gc" title="标题的直接链接">​</a></h2><p>垃圾收集是自动回收不再使用的存储空间的过程，数据可能变成垃圾的几种方式：</p><ul><li><p>延迟删除的对象，对象在删除时标记成已删除，但实际上还没有删除。</p></li><li><p>孤儿数据，比如上传一半的数据。</p></li><li><p>损坏的数据。</p></li></ul><p>对于需要删除的对象，我们使用压缩机制定期清理，下图显示了它的工作流程。</p><p><img loading="lazy" alt="Untitled" src="/assets/images/a21d9c08e9d23718-2cf93e8f139eb06f03e881a22bd2961b.png" width="790" height="610" class="img_ev3q"></p><ol><li><p>垃圾收集器把对象 “/data/b”复制到一个名为“/data/d”的新文件中。这里会跳过对象 2 和 5，因为它们的删除标志都是 true。</p></li><li><p>复制完所有的对象后，垃圾收集器会更新 object_mapping 表，指向新的文件地址，然后删除掉旧的文件。</p></li></ol><p>在本文中，介绍了类似于 S3 的对象存储，比较了块存储、文件存储和对象存储之间的区别，设计了对象上传，对象下载，版本控制功能，并讨论了两种提高可靠性和持久性的方法：复制和纠删码，最后介绍了对象存储的垃圾收集的工作流程。</p><p>希望这篇设计对象存储的文章对大家有用！</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="reference">Reference<a class="hash-link" href="#reference" title="标题的直接链接">​</a></h2><p>[0]<!-- --> System Design Interview Volume 2:
<a href="https://www.amazon.com/System-Design-Interview-Insiders-Guide/dp/1736049119" target="_blank" rel="noopener noreferrer">https://www.amazon.com/System-Design-Interview-Insiders-Guide/dp/1736049119</a></p><p>[1]<!-- --> Fibre channel: <a href="https://en.wikipedia.org/wiki/Fibre_Channel" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Fibre_Channel</a></p><p>[2]<!-- --> iSCSI: <a href="https://en.wikipedia.org/wiki/ISCSI" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/ISCSI</a></p><p>[3]<!-- --> Server Message Block: <a href="https://en.wikipedia.org/wiki/Server_Message_Block" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Server_Message_Block</a></p><p>[4]<!-- --> Network File System: <a href="https://en.wikipedia.org/wiki/Network_File_System" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Network_File_System</a></p><p>[5]<!-- --> Amazon S3 Strong Consistency: <a href="https://aws.amazon.com/s3/consistency/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/s3/consistency/</a></p><p>[6]<!-- --> Serial Attached SCSI: <a href="https://en.wikipedia.org/wiki/Serial_Attached_SCSI" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Serial_Attached_SCSI</a></p><p>[7]<!-- --> AWS CLI ls command: <a href="https://docs.aws.amazon.com/cli/latest/reference/s3/ls.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/cli/latest/reference/s3/ls.html</a></p><p>[8]<!-- --> Amazon S3 Service Level Agreement: <a href="https://aws.amazon.com/s3/sla/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/s3/sla/</a></p><p>[9]<!-- --> Ambry: LinkedIn’s Scalable Geo-Distributed Object Store: <a href="https://assured-cloud-computing.illinois.edu/files/2014/03/Ambry-LinkedIns-Scalable-GeoDistributed-Object-Store.pdf" target="_blank" rel="noopener noreferrer">https://assured-cloud-computing.illinois.edu/files/2014/03/Ambry-LinkedIns-Scalable-GeoDistributed-Object-Store.pdf</a></p><p>[10]<!-- --> inode: <a href="https://en.wikipedia.org/wiki/Inode" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Inode</a></p><p>[11]<!-- --> Ceph’s Rados Gateway: <a href="https://docs.ceph.com/en/pacific/radosgw/index.html" target="_blank" rel="noopener noreferrer">https://docs.ceph.com/en/pacific/radosgw/index.html</a></p><p>[12]<!-- --> grpc: <a href="https://grpc.io/" target="_blank" rel="noopener noreferrer">https://grpc.io/</a></p><p>[13]<!-- --> Paxos: <a href="https://en.wikipedia.org/wiki/Paxos_(computer_science)" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Paxos_(computer_science)</a></p><p>[14]<!-- --> Raft: <a href="https://raft.github.io/" target="_blank" rel="noopener noreferrer">https://raft.github.io/</a></p><p>[15]<!-- --> Consistent hashing: <a href="https://www.toptal.com/big-data/consistent-hashing" target="_blank" rel="noopener noreferrer">https://www.toptal.com/big-data/consistent-hashing</a></p><p>[16]<!-- --> RocksDB: <a href="https://github.com/facebook/rocksdb" target="_blank" rel="noopener noreferrer">https://github.com/facebook/rocksdb</a></p><p>[17]<!-- --> SSTable: <a href="https://www.igvita.com/2012/02/06/sstable-and-log-structured-storage-leveldb/" target="_blank" rel="noopener noreferrer">https://www.igvita.com/2012/02/06/sstable-and-log-structured-storage-leveldb/</a></p><p>[18]<!-- --> B+ tree: <a href="https://en.wikipedia.org/wiki/B%2B_tree" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/B%2B_tree</a></p><p>[19]<!-- --> SQLite: <a href="https://www.sqlite.org/index.html" target="_blank" rel="noopener noreferrer">https://www.sqlite.org/index.html</a></p><p>[20]<!-- --> Data Durability Calculation: <a href="https://www.backblaze.com/blog/cloud-storage-durability/" target="_blank" rel="noopener noreferrer">https://www.backblaze.com/blog/cloud-storage-durability/</a></p><p>[21]<!-- --> Rack: <a href="https://en.wikipedia.org/wiki/19-inch_rack" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/19-inch_rack</a></p><p>[22]<!-- --> Erasure Coding: <a href="https://en.wikipedia.org/wiki/Erasure_code" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Erasure_code</a></p><p>[23]<!-- --> Reed–Solomon error correction: <a href="https://en.wikipedia.org/wiki/Reed%E2%80%93Solomon_error_correction" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Reed%E2%80%93Solomon_error_correction</a></p><p>[24]<!-- --> Erasure Coding Demystified: <a href="https://www.youtube.com/watch?v=Q5kVuM7zEUI" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=Q5kVuM7zEUI</a></p><p>[25]<!-- --> Checksum:<a href="https://en.wikipedia.org/wiki/Checksum" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Checksum</a></p><p>[26]<!-- --> Md5: <a href="https://en.wikipedia.org/wiki/MD5" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/MD5</a></p><p>[27]<!-- --> Sha1: <a href="https://en.wikipedia.org/wiki/SHA-1" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/SHA-1</a></p><p>[28]<!-- --> Hmac: <a href="https://en.wikipedia.org/wiki/HMAC" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/HMAC</a></p><p>[29]<!-- --> TIMEUUID: <a href="https://docs.datastax.com/en/cql-oss/3.3/cql/cql_reference/timeuuid_functions_r.html" target="_blank" rel="noopener noreferrer">https://docs.datastax.com/en/cql-oss/3.3/cql/cql_reference/timeuuid_functions_r.html</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/science09/science09.github.io/tree/main/docs/notes/wechat/【系统设计】S3 对象存储.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">最后<!-- -->由 <b>zhaofeng.luo</b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/面试官：为什么说mysql数据库单表最大两千万？"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">面试官：为什么说mysql数据库单表最大两千万？</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/B站在全链路压测上的实践"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">B站在全链路压测上的实践</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#存储系统" class="table-of-contents__link toc-highlight"><strong>存储系统</strong></a></li><li><a href="#设计要求" class="table-of-contents__link toc-highlight"><strong>设计要求</strong></a></li><li><a href="#对象存储的特点" class="table-of-contents__link toc-highlight">对象存储的特点</a></li><li><a href="#整体设计" class="table-of-contents__link toc-highlight"><strong>整体设计</strong></a></li><li><a href="#上传对象" class="table-of-contents__link toc-highlight"><strong>上传对象</strong></a></li><li><a href="#下载对象" class="table-of-contents__link toc-highlight"><strong>下载对象</strong></a></li><li><a href="#深入设计" class="table-of-contents__link toc-highlight"><strong>深入设计</strong></a></li><li><a href="#数据一致性" class="table-of-contents__link toc-highlight"><strong>数据一致性</strong></a></li><li><a href="#数据存储方式" class="table-of-contents__link toc-highlight">数据存储方式</a></li><li><a href="#数据持久性" class="table-of-contents__link toc-highlight"><strong>数据持久性</strong></a></li><li><a href="#erasure-coding-纠删码" class="table-of-contents__link toc-highlight">Erasure Coding 纠删码</a></li><li><a href="#数据完整性校验" class="table-of-contents__link toc-highlight">数据完整性校验</a></li><li><a href="#版本控制" class="table-of-contents__link toc-highlight"><strong>版本控制</strong></a></li><li><a href="#优化大文件上传" class="table-of-contents__link toc-highlight"><strong>优化大文件上传</strong></a></li><li><a href="#垃圾收集-gc" class="table-of-contents__link toc-highlight">垃圾收集 GC</a></li><li><a href="#reference" class="table-of-contents__link toc-highlight">Reference</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">本站</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">个人笔记</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/notes-intro">技术文摘</a></li></ul></div><div class="col footer__col"><div class="footer__title">我的</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/science09" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/">...</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?d8e6c589e01c3df834c9a1f32e0f9258";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
        
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>  版权所有 © 2022  此网站使用 Docusaurus 构建。</div></div></div></footer></div>
<script src="/assets/js/runtime~main.164e32a3.js"></script>
<script src="/assets/js/main.520d6ac8.js"></script>
</body>
</html>